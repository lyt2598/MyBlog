<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.liaoyingtai.blog.dao.mapper.learningNotes.LearningNotesMapper">


	<resultMap type="com.liaoyingtai.blog.entity.learningNotes.LearningNotes"
	id="learningNotesReultMap">
		<result column="learningNotes_Title" property="learningNotes_Title" />
		<result column="learningNotes_Context" property="learningNotes_Context" />
		<result column="learningNotes_PubDate" property="learningNotes_PubDate" />
		<result column="learningNotes_Stick" property="learningNotes_Stick" />
		<result column="learningNotes_Recommend" property="learningNotes_Recommend" />
		<result column="learningNotes_Private" property="learningNotes_Private" />
		<result column="learningNotes_Comment" property="learningNotes_Comment" />
		<result column="learningNotes_Relay" property="learningNotes_Relay" />
		<result column="learningNotes_ModDate" property="learningNotes_ModDate" />
		<result column="learningNotes_ViewCount" property="learningNotes_ViewCount" />
		<result column="learningNotes_RelayCount" property="learningNotes_ViewCount" />
		<result column="learningNotes_CommentCount" property="learningNotes_ViewCount" />

		<association property="userInfo"
			javaType="com.liaoyingtai.blog.entity.userInfo.UserInfo">
			<id column="learningNotes_PubUser" property="myBlog_UserInfo_id" />
		</association>
		<association property="learningNotesType"
			javaType="com.liaoyingtai.blog.entity.learningNotes.LearningNotesType">
			<id column="learningNotes_Type_id" property="myBlog_LearningNotes_Type_id" />
		</association>

	</resultMap>

	<resultMap type="com.liaoyingtai.blog.entity.learningNotes.LearningNotes"
		id="getLearningNotesListResultMap" extends="learningNotesReultMap">
		<id column="myBlog_LearningNotes_id" property="myBlog_LearningNotes_id" />
	</resultMap>

	<sql id="learningNotes_Field">
		myBlog_LearningNotes_id,learningNotes_Title,learningNotes_Context,learningNotes_PubDate,
		learningNotes_PubUser,learningNotes_Stick,learningNotes_Recommend,learningNotes_Private,
		learningNotes_Comment,learningNotes_Relay,learningNotes_ModDate,learningNotes_ViewCount,
		learningNotes_RelayCount,learningNotes_CommentCount,learningNotes_Type_id
	</sql>
	<sql id="learningNotes_Where">
		<where>
			<if test="uid>0">
				and learningNotes_PubUser = #{uid}
			</if>
			<if test="title!=null and title!=''">
				<!-- 使用concat防止sql注入 -->
				and learningNotes_Title like concat('%',#{title},'%')
			</if>
		</where>
	</sql>

	<sql id="learningNotes_limit">
		<if test="limit>0">
			LIMIT #{begin},#{limit}
		</if>
	</sql>

	<sql id="learningNotes_table">
		myblog_learningnotes
	</sql>
	<sql id="learningNotes_orderBy">
		ORDER BY learningNotes_Stick desc,learningNotes_PubDate
		desc
	</sql>
	<select id="getLearningNotesList"
		parameterType="com.liaoyingtai.blog.entity.learningNotes.LearningNotesCustom"
		resultMap="getLearningNotesListResultMap">
		SELECT
		<include refid="learningNotes_Field" />
		FROM
		<include refid="learningNotes_table" />
		<include refid="learningNotes_Where" />
		<include refid="learningNotes_orderBy" />
		<include refid="learningNotes_limit" />
	</select>
	<select id="getLearningNotesListCount"
		parameterType="com.liaoyingtai.blog.entity.learningNotes.LearningNotesCustom"
		resultType="int">
		SELECT
		count(myBlog_LearningNotes_id)
		FROM
		<include refid="learningNotes_table" />
		<include refid="learningNotes_Where" />
	</select>

</mapper>
