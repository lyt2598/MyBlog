<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.myegames.blog.dao.mapper.index.HeadMenuMapper">

	<sql id="headMenuInfo_Field">
		myBlog_HeadMenu_id,headMenu_Name,headMenu_URL,headMenu_Father,headMenu_UserId
	</sql>
	<sql id="headMenuInfo_Table">
		myblog_headmenu
	</sql>

	<!-- 对应数据库中的所有字段的实体类 -->
	<resultMap type="cn.myegames.blog.entity.index.HeadMenuCustom"
		id="headMenuInfoResultMap">
		<id column="myBlog_HeadMenu_id" property="myBlog_HeadMenu_id" />
		<result column="headMenu_Name" property="headMenu_Name" />
		<result column="headMenu_URL" property="headMenu_URL" />
		<result column="headMenu_Father" property="headMenu_Father" />
		<result column="headMenu_UserId" property="headMenu_UserId" />
	</resultMap>
	<!-- 此层type用来标识返回的类型 -->

	<resultMap type="cn.myegames.blog.entity.index.HeadMenuCustom"
		id="getHeadMenuInfoResultMap" extends="headMenuInfoResultMap">
		<collection property="blogHeadMenus"
			ofType="cn.myegames.blog.entity.index.HeadMenu" column="myBlog_HeadMenu_id"
			select="getChildHeadMenuInfo">
			<id column="headMenu_Father" property="headMenu_Father" />
			<result column="myBlog_HeadMenu_id" property="myBlog_HeadMenu_id" />
			<result column="headMenu_Name" property="headMenu_Name" />
			<result column="headMenu_URL" property="headMenu_URL" />
		</collection>
	</resultMap>

	<select id="getHeadMenuInfo" parameterType="cn.myegames.blog.entity.index.HeadMenuCustom"
		resultMap="getHeadMenuInfoResultMap">
		SELECT
		<include refid="headMenuInfo_Field" />
		FROM
		<include refid="headMenuInfo_Table" />
		WHERE
		headMenu_Father &lt;= 0
		<if test="headMenu_UserId>0">
			and headMenu_UserId=${headMenu_UserId}
		</if>
	</select>
	<select id="getChildHeadMenuInfo" parameterType="int"
		resultType="cn.myegames.blog.entity.index.HeadMenu">
		SELECT
		<include refid="headMenuInfo_Field" />
		FROM
		<include refid="headMenuInfo_Table" />
		WHERE
		headMenu_Father = #{headMenu_Father}
	</select>
</mapper>